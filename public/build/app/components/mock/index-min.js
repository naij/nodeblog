(function(t){var e={version:"0.1.1",_mocked:{}},n=function(){var e={};return e.extend=function(){var n,r,a,o,i=arguments[0]||{},s=1,u=arguments.length;for(1===u&&(i=this,s=0);u>s;s++)if(n=arguments[s])for(r in n)a=i[r],o=n[r],i!==o&&o!==t&&(e.isArray(o)||e.isObject(o)?(e.isArray(o)&&(clone=a&&e.isArray(a)?a:[]),e.isObject(o)&&(clone=a&&e.isObject(a)?a:{}),i[r]=e.extend(clone,o)):i[r]=o);return i},e.each=function(t,e,n){var r,a;if("number"===this.type(t))for(r=0;t>r;r++)e(r,r);else if(t.length===+t.length)for(r=0;r<t.length&&e.call(n,t[r],r,t)!==!1;r++);else for(a in t)if(e.call(n,t[a],a,t)===!1)break},e.type=function(e){return null===e||e===t?String(e):Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1].toLowerCase()},e.each("String Object Array".split(" "),function(t){e["is"+t]=function(n){return e.type(n)===t.toLowerCase()}}),e.isObjectOrArray=function(t){return e.isObject(t)||e.isArray(t)},e.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},e.heredoc=function(t){return t.toString().replace(/^[^\/]+\/\*!?/,"").replace(/\*\/[^\/]+$/,"").trim()},e.noop=function(){},e}(),r=function(){var e={extend:n.extend};return e.extend({"boolean":function(e,n,r){return r!==t?(e="undefined"==typeof e||isNaN(e)?1:parseInt(e,10),n="undefined"==typeof n||isNaN(n)?1:parseInt(n,10),Math.random()>1/(e+n)*e?!r:r):Math.random()>=.5},bool:function(t,e,n){return this.boolean(t,e,n)},natural:function(t,e){return t="undefined"!=typeof t?parseInt(t,10):0,e="undefined"!=typeof e?parseInt(e,10):9007199254740992,Math.round(Math.random()*(e-t))+t},integer:function(t,e){return t="undefined"!=typeof t?parseInt(t,10):-9007199254740992,e="undefined"!=typeof e?parseInt(e,10):9007199254740992,Math.round(Math.random()*(e-t))+t},"int":function(t,e){return this.integer(t,e)},"float":function(e,n,r,a){r=r===t?0:r,r=Math.max(Math.min(r,17),0),a=a===t?17:a,a=Math.max(Math.min(a,17),0);for(var o=this.integer(e,n)+".",i=0,s=this.natural(r,a);s>i;i++)o+=this.character("number");return parseFloat(o,10)},character:function(t){var n={lower:"abcdefghijklmnopqrstuvwxyz",upper:"ABCDEFGHIJKLMNOPQRSTUVWXYZ",number:"0123456789",symbol:"!@#$%^&*()[]"};return n.alpha=n.lower+n.upper,n.undefined=n.lower+n.upper+n.number+n.symbol,t=n[(""+t).toLowerCase()]||t,t.charAt(e.natural(0,t.length-1))},"char":function(t){return this.character(t)},string:function(n,r,a){var o;3===arguments.length&&(o=e.natural(r,a)),2===arguments.length&&("string"==typeof arguments[0]?o=r:(o=e.natural(n,r),n=t)),1===arguments.length&&(o=n,n=t),0===arguments.length&&(o=e.natural(3,7));for(var i="",s=0;o>s;s++)i+=e.character(n);return i},str:function(t,e,n){return this.string(t,e,n)},range:function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var r=Math.max(Math.ceil((e-t)/n),0),a=0,o=new Array(r);r>a;)o[a++]=t,t+=n;return o}}),e.extend({patternLetters:{yyyy:"getFullYear",yy:function(t){return(""+t.getFullYear()).slice(2)},y:"yy",MM:function(t){var e=t.getMonth()+1;return 10>e?"0"+e:e},M:function(t){return t.getMonth()+1},dd:function(t){var e=t.getDate();return 10>e?"0"+e:e},d:"getDate",HH:function(t){var e=t.getHours();return 10>e?"0"+e:e},H:"getHours",hh:function(t){var e=t.getHours()%12;return 10>e?"0"+e:e},h:function(t){return t.getHours()%12},mm:function(t){var e=t.getMinutes();return 10>e?"0"+e:e},m:"getMinutes",ss:function(t){var e=t.getSeconds();return 10>e?"0"+e:e},s:"getSeconds",SS:function(t){var e=t.getMilliseconds();return 10>e&&"00"+e||100>e&&"0"+e||e},S:"getMilliseconds",A:function(t){return t.getHours()<12?"AM":"PM"},a:function(t){return t.getHours()<12?"am":"pm"}}}),e.extend({rformat:new RegExp(function(){var t=[];for(var n in e.patternLetters)t.push(n);return"("+t.join("|")+")"}(),"g"),format:function(t,n){var r=e.patternLetters,a=e.rformat;return n.replace(a,function(e,n){return"function"==typeof r[n]?r[n](t):r[n]in r?arguments.callee(e,r[n]):t[r[n]]()})},randomDate:function(e,n){return e=e===t?new Date(0):e,n=n===t?new Date:n,new Date(Math.random()*(n.getTime()-e.getTime()))},date:function(t){return t=t||"yyyy-MM-dd",this.format(this.randomDate(),t)},time:function(t){return t=t||"HH:mm:ss",this.format(this.randomDate(),t)},datetime:function(t){return t=t||"yyyy-MM-dd HH:mm:ss",this.format(this.randomDate(),t)}}),e.extend({ad_size:["300x250","250x250","240x400","336x280","180x150","720x300","468x60","234x60","88x31","120x90","120x60","120x240","125x125","728x90","160x600","120x600","300x600"],screen_size:["320x200","320x240","640x480","800x480","800x480","1024x600","1024x768","1280x800","1440x900","1920x1200","2560x1600"],video_size:["720x480","768x576","1280x720","1920x1080"],img:function(e,n,r,a,o){return 4===arguments.length&&(o=a,a=t),3===arguments.length&&(o=r),e||(e=this.pick(this.ad_size)),n&&~n.indexOf("#")&&(n=n.slice(1)),r&&~r.indexOf("#")&&(r=r.slice(1)),"http://dummyimage.com/"+e+(n?"/"+n:"")+(r?"/"+r:"")+(a?"."+a:"")+(o?"&text="+o:"")}}),e.extend({color:function(){var t=Math.floor(16777215*Math.random()).toString(16);return t="#"+("000000"+t).slice(-6)}}),e.extend({capitalize:function(t){return t.charAt(0).toUpperCase()+t.substr(1)},upper:function(t){return t.toUpperCase()},lower:function(t){return t.toLowerCase()},pick:function(t){return t[this.natural(0,t.length-1)]},shuffle:function(t){for(var e=t.slice(0),n=[],r=0,a=e.length,o=0;a>o;o++)r=this.natural(0,e.length-1),n.push(e[r]),e.splice(r,1);return n}}),e.extend({paragraph:function(t,n){var r;0===arguments.length&&(r=e.natural(3,7)),1===arguments.length&&(r=n=t),2===arguments.length&&(t=parseInt(t,10),n=parseInt(n,10),r=e.natural(t,n));for(var a=[],o=0;r>o;o++)a.push(e.sentence());return a.join(" ")},sentence:function(t,n){var r;0===arguments.length&&(r=e.natural(12,18)),1===arguments.length&&(r=n=t),2===arguments.length&&(t=parseInt(t,10),n=parseInt(n,10),r=e.natural(t,n));for(var a=[],o=0;r>o;o++)a.push(e.word());return e.capitalize(a.join(" "))+"."},word:function(t,n){var r;0===arguments.length&&(r=e.natural(3,10)),1===arguments.length&&(r=n=t),2===arguments.length&&(t=parseInt(t,10),n=parseInt(n,10),r=e.natural(t,n));for(var a="",o=0;r>o;o++)a+=e.character("lower");return a},title:function(t,n){var r,a=[];0===arguments.length&&(r=e.natural(3,7)),1===arguments.length&&(r=n=t),2===arguments.length&&(t=parseInt(t,10),n=parseInt(n,10),r=e.natural(t,n));for(var o=0;r>o;o++)a.push(this.capitalize(this.word()));return a.join(" ")}}),e.extend({first:function(){var t=["James","John","Robert","Michael","William","David","Richard","Charles","Joseph","Thomas","Christopher","Daniel","Paul","Mark","Donald","George","Kenneth","Steven","Edward","Brian","Ronald","Anthony","Kevin","Jason","Matthew","Gary","Timothy","Jose","Larry","Jeffrey","Frank","Scott","Eric"].concat(["Mary","Patricia","Linda","Barbara","Elizabeth","Jennifer","Maria","Susan","Margaret","Dorothy","Lisa","Nancy","Karen","Betty","Helen","Sandra","Donna","Carol","Ruth","Sharon","Michelle","Laura","Sarah","Kimberly","Deborah","Jessica","Shirley","Cynthia","Angela","Melissa","Brenda","Amy","Anna"]);return this.pick(t)},last:function(){var t=["Smith","Johnson","Williams","Brown","Jones","Miller","Davis","Garcia","Rodriguez","Wilson","Martinez","Anderson","Taylor","Thomas","Hernandez","Moore","Martin","Jackson","Thompson","White","Lopez","Lee","Gonzalez","Harris","Clark","Lewis","Robinson","Walker","Perez","Hall","Young","Allen"];return this.pick(t)},name:function(t){return this.first()+" "+(t?this.first()+" ":"")+this.last()}}),e.extend({url:function(){return"http://"+this.domain()+"/"+this.word()},domain:function(t){return this.word()+"."+(t||this.tld())},email:function(t){return this.character("lower")+"."+this.last().toLowerCase()+"@"+this.last().toLowerCase()+"."+this.tld()},ip:function(){return this.natural(0,255)+"."+this.natural(0,255)+"."+this.natural(0,255)+"."+this.natural(0,255)},tlds:["com","org","edu","gov","co.uk","net","io"],tld:function(){return this.pick(this.tlds)}}),e.extend({areas:["\u6d93\u6ec3\u5bf3","\u9357\u5ea1\u5bf3","\u9357\u5e9d\u7b22","\u9357\u5e9d\u8151","\u9357\u5ea1\u5d21","\u7457\u57ae\u5d21","\u7457\u57ae\u5bf3"],area:function(){return this.pick(this.areas)},regions:["110000 \u9356\u693e\u542b\u752f\ufffd","120000 \u6fb6\u2542\u89e6\u752f\ufffd","130000 \u5a0c\u51b2\u5bf3\u942a\ufffd","140000 \u705e\u8fab\u30bf\u942a\ufffd","150000 \u9350\u5470\u630b\u9359\u3088\u569c\u5a0c\u8bf2\u5c2f","210000 \u6748\u85c9\u755e\u942a\ufffd","220000 \u935a\u590b\u7044\u942a\ufffd","230000 \u699b\u6226\u7df3\u59f9\u71ba\u6e37","310000 \u6d93\u5a43\u6363\u752f\ufffd","320000 \u59f9\u71bb\u5ac3\u942a\ufffd","330000 \u5a34\u6b10\u7759\u942a\ufffd","340000 \u7039\u590a\u7a98\u942a\ufffd","350000 \u7ec2\u5fd3\u7f13\u942a\ufffd","360000 \u59f9\u71bb\u30bf\u942a\ufffd","370000 \u705e\u53d8\u7b22\u942a\ufffd","410000 \u5a0c\u51b2\u5d21\u942a\ufffd","420000 \u5a40\u6827\u5bf3\u942a\ufffd","430000 \u5a40\u6827\u5d21\u942a\ufffd","440000 \u9a9e\u5938\u7b22\u942a\ufffd","450000 \u9a9e\u80ef\u30bf\u6fb9\ue1bd\u68cc\u9477\ue045\u4e0d\u9356\ufffd","460000 \u5a34\u5cf0\u5d21\u942a\ufffd","500000 \u95b2\u5d85\u7c21\u752f\ufffd","510000 \u9365\u6d98\u7a9b\u942a\ufffd","520000 \u7490\u975b\u7a9e\u942a\ufffd","530000 \u6d5c\u621d\u5d21\u942a\ufffd","540000 \u7457\u80ef\u68cc\u9477\ue045\u4e0d\u9356\ufffd","610000 \u95c4\u66e1\u30bf\u942a\ufffd","620000 \u9422\u6a3f\u5011\u942a\ufffd","630000 \u95c8\u6393\u6363\u942a\ufffd","640000 \u7039\u4f78\ue634\u9365\u70b4\u68cc\u9477\ue045\u4e0d\u9356\ufffd","650000 \u93c2\u626e\u6782\u7f01\u6751\u60e5\u704f\u65c7\u569c\u5a0c\u8bf2\u5c2f","650000 \u93c2\u626e\u6782\u7f01\u6751\u60e5\u704f\u65c7\u569c\u5a0c\u8bf2\u5c2f","710000 \u9359\u7248\u5495\u942a\ufffd","810000 \u68e3\u6b10\u8150\u9417\u7470\u57c6\u741b\u5c7e\u6582\u9356\ufffd","820000 \u5a62\u62bd\u68ec\u9417\u7470\u57c6\u741b\u5c7e\u6582\u9356\ufffd"],region:function(){return this.pick(this.regions).split(" ")[1]},address:function(){},city:function(){},phone:function(){},areacode:function(){},street:function(){},street_suffixes:function(){},street_suffix:function(){},states:function(){},state:function(){},zip:function(t){for(var e="",n=0;(t||6)>n;n++)e+=this.natural(0,9);return e}}),e.extend({todo:function(){return"todo"}}),e.extend({d4:function(){return this.natural(1,4)},d6:function(){return this.natural(1,6)},d8:function(){return this.natural(1,8)},d12:function(){return this.natural(1,12)},d20:function(){return this.natural(1,20)},d100:function(){return this.natural(1,100)},guid:function(){var t="ABCDEF1234567890",e=this.string(t,8)+"-"+this.string(t,4)+"-"+this.string(t,4)+"-"+this.string(t,4)+"-"+this.string(t,12);return e},id:function(){var t,e=0,n=["7","9","10","5","8","4","2","1","6","3","7","9","10","5","8","4","2"],r=["1","0","X","9","8","7","6","5","4","3","2"];t=this.pick(this.regions).split(" ")[0]+this.date("yyyyMMdd")+this.string("number",3);for(var a=0;a<t.length;a++)e+=t[a]*n[a];return t+=r[e%11]}}),e}(),a=/(.+)\|(?:\+(\d+)|(\d+-?\d*)?(?:\.(\d+-?\d*))?)/,o=/(\d+)-?(\d+)?/,i=/\\*@([^@#%&()\?\s\/\.]+)(?:\((.+?)\))?/g;e.extend=n.extend,e.mock=function(t,n){return 1===arguments.length?s.gen(t):(e._mocked[t]={rurl:t,template:n},e)};var s={extend:n.extend};s.gen=function(t,e,i){var u,l=(e=e||"").match(a),h=l&&l[3]&&l[3].match(o),c=h&&parseInt(h[1],10),p=h&&parseInt(h[2],10),f=h?!h[2]&&parseInt(h[1],10)||r.integer(c,p):1,g=l&&l[4]&&l[4].match(o),d=g&&parseInt(g[1],10),m=g&&parseInt(g[2],10),y=g?!g[2]&&parseInt(g[1],10)||r.integer(d,m):0,x=l&&l[4],v=n.type(t);return s[v]?u=s[v]({type:v,template:t,name:e,obj:i,parameters:l,range:h,min:c,max:p,count:f,decimal:g,dmin:d,dmax:m,dcount:y,point:x}):t},s.extend({array:function(t){var e,n,a=[];if(t.parameters)if(1===t.count&&t.template.length>1)a=r.pick(t.template);else for(e=0;e<t.count;e++){n=0;do a.push(s.gen(t.template[n++]));while(n<t.template.length)}else for(e=0;e<t.template.length;e++)a.push(s.gen(t.template[e]));return a},object:function(t){var e,r,o={};for(e in t.template)o[e.replace(a,"$1")]=s.gen(t.template[e],e,o),r=e.match(a),r&&r[2]&&"number"===n.type(t.template[e])&&(t.template[e]+=parseInt(r[2],10));return o},number:function(t){var e,n,a;if(t.point){for(t.template+="",n=t.template.split("."),n[0]=t.range?t.count:n[0],n[1]=(n[1]||"").slice(0,t.dcount),a=0;n[1].length<t.dcount;a++)n[1]+=r.character("number");e=parseFloat(n.join("."),10)}else e=t.range&&!t.parameters[2]?t.count:t.template;return e},"boolean":function(t){var e;return e=t.parameters?r.bool(t.min,t.max,t.template):t.template},string:function(t){var e,a,o,u,l="";if(t.template.length){for(e=0;e<t.count;e++)l+=t.template;for(a=l.match(i)||[],e=0;e<a.length;e++)if(o=a[e],/^\\/.test(o))a.splice(e--,1);else{if(u=s.placeholder(o,t.obj),1===a.length&&o===l){if(n.isNumeric(u)){l=parseFloat(u,10);break}if(/^(true|false)$/.test(u)){l="true"===u?!0:!1;break}}l=l.replace(o,u)}}else l=t.range?r.string(t.count):t.template;return l}}),s.extend({placeholder:function(e,a){i.exec("");var o=i.exec(e),u=o&&o[1],l=u&&u.toLowerCase(),h=o&&o[2]?o[2].split(/,\s*/):[];if(a&&u in a)return a[u];if(!(u in r||l in r))return e;for(var c=0;c<h.length;c++)i.exec(""),i.test(h[c])&&(h[c]=s.placeholder(h[c],a));var p=r[u]||r[l];switch(n.type(p)){case"array":return r.pick(p);case"function":var f=p.apply(r,h);return f===t&&(f=""),f}}}),e.mockjax=function(t){function n(){return{open:t.noop,send:t.noop,getAllResponseHeaders:t.noop,readyState:4,status:200}}function r(t){return function(){return e.mock(t.template)}}function a(a){for(var o in e._mocked){var i=e._mocked[o];if(("string"!==t.type(i.rurl)||i.rurl===a.url)&&("regexp"!==t.type(i.rurl)||i.rurl.test(a.url))){a.dataFilter=r(i),a.converters["text json"]=r(i),a.xhr=n;break}}}return t.ajaxPrefilter("*",a),t.ajaxPrefilter("json",a),t.ajaxPrefilter("jsonp",a),e},"undefined"!=typeof jQuery&&e.mockjax(jQuery),"undefined"!=typeof KISSY&&KISSY.add&&(e.mockjax=function(t){var n=t.io,r={readyState:4,responseText:"",responseXML:null,state:2,status:200,statusText:"success",timeoutTimer:null};t.io=function(a){for(var o in e._mocked){var i=e._mocked[o];if(("string"!==t.type(i.rurl)||i.rurl===a.url)&&("regexp"!==t.type(i.rurl)||i.rurl.test(a.url))){console.log("[mock]",a.url,">",i.rurl);var s=e.mock(i.template);return console.log("[mock]",s),a.success&&a.success(s,"success",r),a.complete&&a.complete(s,"success",r),t}}return n.apply(this,arguments)}}),e.Util=n,e.Random=r,"object"==typeof module&&module.exports?module.exports=e:"function"==typeof define&&define.amd&&define(function(){return e}),this.Mock=e,this.Random=r,"undefined"!=typeof KISSY&&(KISSY.add("mock",function(t){return e.mockjax(t),e},{requires:["ajax"]}),KISSY.add("components/mock/index",function(t){return e.mockjax(t),e},{requires:["ajax"]}),KISSY.add("mock/dist/mock",function(t){return e.mockjax(t),e},{requires:["ajax"]})),function(t){var a={version:"0.0.1"};this.Mock||(module.exports=a),e.tpl=function(t,e,n,r){return a.mock(t,e,n,r)},e.parse=function(t){return Handlebars.parse(t)},a.mock=function(t,e,r,a){return r=r?n.extend({},r,Handlebars.helpers):Handlebars.helpers,a=a?n.extend({},a,Handlebars.partials):Handlebars.partials,o.gen(t,null,e,r,a)};var o={debug:a.debug||!1,extend:n.extend};o.gen=function(t,e,r,i,s){if(n.isString(t)){var u=Handlebars.parse(t);r=o.parseOptions(t,r);var l=o.gen(u,e,r,i,s);return l}if(e=e||[{}],r=r||{},this[t.type]!==n.noop){r.__path=r.__path||[],(a.debug||o.debug)&&(console.log(),console.group("["+t.type+"]",JSON.stringify(t)),console.log("[options]",r.__path.length,JSON.stringify(r)));var h=r.__path.length;return this[t.type](t,e,r,i,s),r.__path.splice(h),(a.debug||o.debug)&&console.groupEnd(),e[e.length-1]}},o.parseOptions=function(t,e){var r,a,o,i=/<!--\s*\n*Mock\s*\n*([\w\W]+?)\s*\n*-->/g,s=t.match(i),u={};for(r=0;s&&r<s.length;r++)i.lastIndex=0,a=i.exec(s[r]),a&&(o=new Function("return "+a[1]),o=o(),n.extend(u,o));return n.extend(u,e)},o.val=function(i,s,u,l){if(i!==s.__path[s.__path.length-1])throw new Error(i+"!=="+s.__path);if((a.debug||o.debug)&&console.log("[options]",i,s.__path),l!==t&&(l=e.mock(l)),s){var h=e.mock(s);if(n.isString(h))return h;if(i in h)return h[i]}return n.isArray(u[0])?{}:l!==t?l:i||r.word()},o.program=function(t,e,n,r,a){for(var o=0;o<t.statements.length;o++)this.gen(t.statements[o],e,n,r,a)},o.mustache=function(t,e,r,a,o){var i,s=e[0],u=e.length;if("array"===n.type(s)&&(s.push({}),s=s[s.length-1],e.unshift(s)),t.isHelper||a&&a[t.id.string]){if(0===t.params.length);else for(i=0;i<t.params.length;i++)this.gen(t.params[i],e,r,a,o);t.hash&&this.gen(t.hash,e,r,a,o)}else this.gen(t.id,e,r,a,o);e.length>u&&e.splice(0,e.length-u)},o.block=function(t,e,a,o,s){var u,l,h,c,p,f=t.mustache.id.parts,g=e[0],d=e.length;if(t.inverse,t.mustache.isHelper||o&&o[t.mustache.id.string])p=f[0],c=(i[p]||i.custom).apply(this,arguments),g=e[0];else for(u=0;u<f.length;u++)a.__path.push(f[u]),h=f[u],c=this.val(h,a,e,{}),g[h]=n.isArray(c)&&[]||c,p=n.type(g[h]),("object"===p||"array"===p)&&(g=g[h],e.unshift(g));if(t.program)if("array"===n.type(g))for(l=c.length||r.integer(3,7),u=0;l>u;u++)g.push("undefined"!=typeof c[u]?c[u]:{}),a.__path.push("[]"),e.unshift(g[g.length-1]),this.gen(t.program,e,a,o,s),a.__path.pop(),e.shift();else this.gen(t.program,e,a,o,s);e.length>d&&e.splice(0,e.length-d)},o.hash=function(t,e,n,r,a){var o,i,s,u=t.pairs;for(i=0;i<u.length;i++)for(o=u[i],s=1;s<o.length;s++)this.gen(o[s],e,n,r,a)},o.ID=function(t,e,r){var a,o,i,s,u,l,h,c,p,f=t.parts,g=e[t.depth],d=e.length;if(n.isArray(g)&&(g=e[t.depth+1]),f.length)for(a=0,o=f.length;o>a;a++)r.__path.push(f[a]),i=f[a],s=f[a-1],p=r[s],u=a===o-1?g[i]:{},l=this.val(i,r,e,u),h=n.type(g[i]),c=n.type(l),"undefined"===h?g[i]=o-1>a&&"object"!==c&&"array"!==c?{}:n.isArray(l)&&[]||l:o-1>a&&"object"!==h&&"array"!==h&&(g[i]=n.isArray(l)&&[]||{}),h=n.type(g[i]),("object"===h||"array"===h)&&(g=g[i],e.unshift(g));else;e.length>d&&e.splice(0,e.length-d)},o.partial=function(t,e,n,r,a){var i=t.partialName.name,s=a&&a[i],u=e.length;s&&o.gen(s,e,n,r,a),e.length>u&&e.splice(0,e.length-u)},o.content=n.noop,o.PARTIAL_NAME=n.noop,o.DATA=n.noop,o.STRING=n.noop,o.INTEGER=n.noop,o.BOOLEAN=n.noop,o.comment=n.noop;var i={};i.each=function(t,e,r){var a,o,i,s,u,l,h,c=e[0];for(u=t.mustache.params[0].parts,a=0,o=u.length;o>a;a++)r.__path.push(u[a]),i=u[a],l=a===o-1?[]:{},s=this.val(i,r,e,l),c[i]=n.isArray(s)&&[]||s,h=n.type(c[i]),("object"===h||"array"===h)&&(c=c[i],e.unshift(c));return s},i["if"]=i.unless=function(t,e,r){var a,o,i,s,u,l,h=t.mustache.params,c=e[0];for(a=0;a<h.length;a++)for(parts=h[a].parts,o=0;o<parts.length;o++)0===a&&r.__path.push(parts[o]),i=parts[o],u=o===parts.length-1?"@BOOL(2,1,true)":{},s=this.val(i,r,e,u),o===parts.length-1&&(s="true"===s?!0:"false"===s?!1:s),c[i]=n.isArray(s)?[]:s,l=n.type(c[i]),("object"===l||"array"===l)&&(c=c[i],e.unshift(c));return s},i["with"]=function(t,e,n){var r,a,o,i,s,u=e[0];for(i=t.mustache.params[0].parts,r=0;r<i.length;r++)n.__path.push(i[r]),a=i[r],s={},o=this.val(a,n,e,s),u=u[a]=o,e.unshift(u);return o},i.log=function(){},i.custom=function(t,e,r){var a,o,i,s,u,l,h,c=e[0];if(0!==t.mustache.params.length){for(u=t.mustache.params[0].parts,a=0,o=u.length;o>a;a++)r.__path.push(u[a]),i=u[a],l=a===o-1?[]:{},s=this.val(i,r,e,l),c[i]=n.isArray(s)&&[]||s,h=n.type(c[i]),("object"===h||"array"===h)&&(c=c[i],e.unshift(c));return s}}}.call(this),function(t){if("undefined"!=typeof KISSY){var a,o={debug:!1};KISSY.use("xtemplate",function(t,e){a=e}),this.Mock||(module.exports=o),e.xtpl=function(t,e,n,r){return o.mock(t,e,n,r)},e.xparse=function(t){return a.compiler.parse(t)},o.mock=function(t,e,r,o){return r=r?n.extend({},r,a.RunTime.commands):a.RunTime.commands,o=o?n.extend({},o,a.RunTime.subTpls):a.RunTime.subTpls,this.gen(t,null,e,r,o,{})},o.parse=function(t){return a.compiler.parse(t)},o.gen=function(t,e,r,a,i,s){if("string"==typeof t){o.debug&&console.log("[tpl    ]\n",t);var u=this.parse(t);r=this.parseOptions(t,r);var l=this.gen(u,e,r,a,i,s);return l}if(e=e||[{}],r=r||{},this[t.type]!==n.noop){r.__path=r.__path||[],o.debug&&(console.log(),console.group("["+t.type+"]",JSON.stringify(t)),console.log("[context]","[before]",e.length,JSON.stringify(e)),console.log("[options]","[before]",r.__path.length,JSON.stringify(r)),console.log("[other  ]","[before]",JSON.stringify(s)));var h=r.__path.length;return this[t.type](t,e,r,a,i,s),o.debug&&console.log("[__path ]","[after ]",r.__path),(!s.hold||"function"==typeof s.hold&&!s.hold(t,r,e))&&r.__path.splice(h),o.debug&&(console.log("[context]","[after ]",e.length,JSON.stringify(e)),console.groupEnd()),e[e.length-1]}},o.parseOptions=function(t,e){var r,a,o,i=/<!--\s*\n*Mock\s*\n*([\w\W]+?)\s*\n*-->/g,s=t.match(i),u={};for(r=0;s&&r<s.length;r++)i.lastIndex=0,a=i.exec(s[r]),a&&(o=new Function("return "+a[1]),o=o(),n.extend(u,o));return n.extend(u,e)},o.parseVal=function(t,e){function r(t,e){if("object"==typeof e&&t in e)return[e[t]];for(var n=[],r=0;r<e.length;r++)n.push.apply(n,o(t,[e[r]]));return n}function a(t,e){if("object"==typeof e&&t in e)return[e[t]];var n=[];for(var r in e)n.push.apply(n,o(t,[e[r]]));return n}function o(t,e){for(var o=[],i=0;i<e.length;i++)"object"==typeof e[i]&&(t in e[i]?o.push(e[i][t]):o.push.apply(o,n.isArray(e[i])?r(t,e[i]):a(t,e[i])));return o}function i(t,e){for(var n="string"==typeof t?t.split("."):t.slice(0),r=[e];n.length;)r=o(n.shift(),r);return r}return i(t,e)},o.val=function(r,a,i,s){if(r!==a.__path[a.__path.length-1])throw new Error(r+"!=="+a.__path);if(s!==t&&(s=e.mock(s)),a){var u=e.mock(a);if(n.isString(u))return u;var l=o.parseVal(a.__path,u);if(l.length>0)return l[0];if(r in u)return u[r]}return n.isArray(i[0])?{}:s!==t?s:r},o.program=function(t,e,n,r,a,o){for(var i=0;i<t.statements.length;i++)this.gen(t.statements[i],e,n,r,a,o);for(var s=0;t.inverse&&s<t.inverse.length;s++)this.gen(t.inverse[s],e,n,r,a,o)},o.block=function(e,a,o,i,s,u){var l=a.length;this.gen(e.tpl,a,o,i,s,n.extend({},u,{def:{},hold:!0}));var h,c,p,f=a[0];if("array"===n.type(f))for(h=this.val(o.__path[o.__path.length-1],o,a),p=h&&h.length||r.integer(3,7),c=0;p>c;c++)f.push(h&&h[c]!==t?h[c]:{}),o.__path.push(c),a.unshift(f[f.length-1]),this.gen(e.program,a,o,i,s,u),o.__path.pop(),a.shift();else this.gen(e.program,a,o,i,s,u);(!u.hold||"function"==typeof u.hold&&!u.hold(e,o,a))&&a.splice(0,a.length-l)},o.tpl=function(t,e,r,a,o,i){if(t.params&&t.params.length){i=n.extend({},i,{def:{each:[],"if":"@BOOL(2,1,true)",unless:"@BOOL(2,1,false)","with":{}}[t.path.string],hold:{each:!0,"if":function(t,e,n,r,a){return"object"==typeof a},unless:function(t,e,n,r,a){return"object"==typeof a},"with":!0,include:!1}[t.path.string]});for(var s,u=0;u<t.params.length;u++)s="include"===t.path.string?o&&o[t.params[u].value]:t.params[u],s&&this.gen(s,e,r,a,o,i);t.hash&&this.gen(t.hash,e,r,a,o,i)}else this.gen(t.path,e,r,a,o,i)},o.tplExpression=function(t,e,n,r,a,o){this.gen(t.expression,e,n,r,a,o)},o.content=n.noop,o.unaryExpression=n.noop,o.multiplicativeExpression=o.additiveExpression=function(e,a,o,i,s,u){this.gen(e.op1,a,o,i,s,n.extend({},u,{def:function(){return"number"===e.op2.type?e.op2.value.indexOf(".")>-1?r.float(-Math.pow(10,10),Math.pow(10,10),1,Math.pow(10,6)):r.integer():t}()})),this.gen(e.op2,a,o,i,s,n.extend({},u,{def:function(){return"number"===e.op1.type?e.op1.value.indexOf(".")>-1?r.float(-Math.pow(10,10),Math.pow(10,10),1,Math.pow(10,6)):r.integer():t}()}))},o.relationalExpression=function(t,e,n,r,a,o){this.gen(t.op1,e,n,r,a,o),this.gen(t.op2,e,n,r,a,o)},o.equalityExpression=n.noop,o.conditionalAndExpression=n.noop,o.conditionalOrExpression=n.noop,o.string=n.noop,o.number=n.noop,o.boolean=n.noop,o.hash=function(t,e,n,r,a,o){var i,s=t.value;for(i in s)this.gen(s[i],e,n,r,a,o)},o.id=function(e,r,a,i,s,u){function l(t,e,r,a,o){var i=n.type(t[a]),s=n.type(o);return o="true"===o?!0:"false"===o?!1:o,"undefined"===i?t[a]=r-1>e&&!n.isObjectOrArray(o)?{}:n.isArray(o)&&[]||o:r-1>e&&"object"!==i&&"array"!==i?t[a]=n.isArray(o)&&[]||{}:"object"!==i&&"array"!==i&&"object"!==s&&"array"!==s&&(t[a]=o),t[a]}var h,c,p,f,g,d=r.length,m=e.parts,y=r[e.depth];for(n.isArray(y)&&(y=r[e.depth+1]),h=0,c=m.length;c>h;h++)(0!==h||"this"!==m[h])&&(/^(xindex|xcount|xkey)$/.test(m[h])||0===h&&1===c&&m[h]in i||(a.__path.push(m[h]),p=m[h],f=h===c-1?u.def!==t?u.def:r[0][p]:{},g=this.val(p,a,r,f),o.debug&&(console.log("[def    ]",JSON.stringify(f)),console.log("[val    ]",JSON.stringify(g))),g=l(y,h,c,p,g),n.isObjectOrArray(y[p])&&r.unshift(y=y[p])));(!u.hold||"function"==typeof u.hold&&!u.hold(e,a,r,p,g))&&r.splice(0,r.length-d)}}}.call(this)}).call(this);