KISSY.add("app/models/basemodel",function(e,o,s,i){var t=0,a={CodeMap:{601:{method:"processLogin",validTime:12e4},2:{method:"processVCode",validTime:6e4}},isIntervene:function(){return this.$ii},processLogin:function(o,s){var i=this,t=i.$lastLTime;s||t&&!(e.now()-t<o)?(i.$lastLTime=e.now(),i.processCode()):i.processCode()},processVCode:function(o,s){var i=this,t=i.$lastVCTime;s||t&&!(e.now()-t<o)?(i.$lastVCTime=e.now(),i.processCode()):i.processCode()},getJSONPToken:function(){},processCode:function(){var e=this,o=e.$code;if(o){var s=o.list.shift();if(s){delete o.hash[s.code];var i=e.CodeMap[s.code];if(!i)throw new Error("unrecognize error code:"+s);e[i.method](i.validTime,s.iVT)}else e.runWaitModels()}else e.runWaitModels()},start:function(e,o){var s=this;s.$code||(s.$code={list:[],hash:{}},Magix.has(s.$code.hash,e)||(s.$code.list.push({code:e,iVT:o}),s.$code.hash[e]=!0)),s.$ii||(s.$ii=!0,s.processCode())},addWaitModel:function(e,o){var s=this;s.$wmList||(s.$wmList=[]),s.$wmList.push({model:e,options:o})},runWaitModels:function(){var e=this,o=e.$wmList;if(e.$ii){if(delete e.$ii,o)for(var s,i=0;i<o.length;i++)s=o[i],s.model.sync(s.options);e.$wmList=[]}}};return o.extend({parse:function(e){return e},sync:function(o){var s=this;if(t++,a.isIntervene())return void a.addWaitModel(s,d);var r,n=s.get("url"),d=s.get("options")||{},c=d.type||"GET",l=d.jsonp,u=d.async,p=d.dataType||"json",h=d.noVerify;"GET"===c.toUpperCase()?(s.setUrlParams("t",e.now()),r=s.getUrlParams()):r=s.getPostParams();var m={url:n,type:c,data:r,dataType:p,async:u===!1?!1:!0,success:function(e){if("json"==p){if(e.data.hasOwnProperty("hasLogin")&&e.data.hasLogin===!1)return void(window.location.href="/#!/manage/login");if(h)return void o(null,e);e.info.ok?o(null,{data:e.data}):(i.showGlobalTip(e.info.message),o(s.message||"request error"))}else try{o(null,{data:e.data})}catch(s){i.showGlobalTip(s.message),o(s.message||"request error")}},error:function(e,s){o(s||"request error")},complete:function(){t--}};return l&&(m.jsonp=l===!0?"_c":l),KISSY.io(m)}})},{requires:["mxext/model","ajax","app/util/util"]});